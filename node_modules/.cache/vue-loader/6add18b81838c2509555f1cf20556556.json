{"remainingRequest":"E:\\WorkSpace\\SchoolWorkSpace\\dp_font\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WorkSpace\\SchoolWorkSpace\\dp_font\\src\\components\\LoginComponent.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\WorkSpace\\SchoolWorkSpace\\dp_font\\src\\components\\LoginComponent.vue","mtime":1610500068643},{"path":"E:\\WorkSpace\\SchoolWorkSpace\\dp_font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WorkSpace\\SchoolWorkSpace\\dp_font\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\WorkSpace\\SchoolWorkSpace\\dp_font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WorkSpace\\SchoolWorkSpace\\dp_font\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogIkxvZ2luQ29tcG9uZW50IiwNCiAgICBkYXRhKCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgY2FwdGNoYV91cmw6ICIiLA0KICAgICAgICAgICAgcnVsZUZvcm06IHsNCiAgICAgICAgICAgICAgICAvL2NhcHRjaGFfa2V5OiAiIiwNCiAgICAgICAgICAgICAgICAvL2NhcHRjaGE6ICIiLA0KICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAiIiwNCiAgICAgICAgICAgICAgICBwYXNzd29yZDogIiIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcnVsZXM6IHsNCiAgICAgICAgICAgICAgICB1c2VybmFtZTogWw0KICAgICAgICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fovpPlhaXnlKjmiLflkI0iLCB0cmlnZ2VyOiAiYmx1ciIgfSwNCiAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpeWvhueggSIsIHRyaWdnZXI6ICJibHVyIiB9XSwNCiAgICAgICAgICAgICAgICBjYXB0Y2hhOiBbeyByZXF1aXJlZDogZmFsc2UsIG1lc3NhZ2U6ICLor7fovpPlhaXpqozor4HnoIEiLCB0cmlnZ2VyOiAiYmx1ciIgfV0sDQogICAgICAgICAgICB9LA0KICAgICAgICB9Ow0KICAgIH0sDQogICAgbWV0aG9kczogew0KICAgICAgICBzdWJtaXRGb3JtKGZvcm1OYW1lKSB7DQogICAgICAgICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSgodmFsaWQpID0+IHsNCiAgICAgICAgICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5heGlvcy5wb3N0KCd1c2VyL2xvZ2luJywgdGhpcy5ydWxlRm9ybSkudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b2tlbiA9IHJlc3BvbnNlLmRhdGEudG9rZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpZCA9IHJlc3BvbnNlLmRhdGEuaWQNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2F2ZVVzZXJJbmZvJywgeyd1c2VybmFtZSc6IHRoaXMucnVsZUZvcm0udXNlcm5hbWUsICd0b2tlbic6IHRva2VuLCAnaWQnOiBpZH0pDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7bmFtZTogJ0hvbWUnfSkNCiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hfY2FwdGNoYSgpDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGVycm9yLnJlc3BvbnNlLmRhdGEuZGV0YWlsKTsgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3Igc3VibWl0ISEnKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LA0KICAgICAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsNCiAgICAgICAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnJlc2V0RmllbGRzKCk7DQogICAgICAgIH0sDQogICAgICAgIHJlZnJlc2hfY2FwdGNoYSgpIHsNCiAgICAgICAgICAgIHRoaXMuYXhpb3MuZ2V0KCdjYXB0Y2hhL3JlZnJlc2gvJywgeyBoZWFkZXJzIDogeydYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0J30gfSkudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLmNhcHRjaGFfdXJsID0gcmVzcG9uc2UuZGF0YS5pbWFnZV91cmw7DQogICAgICAgICAgICAgICAgdGhpcy5ydWxlRm9ybS5jYXB0Y2hhX2tleSA9IHJlc3BvbnNlLmRhdGEua2V5Ow0KICAgICAgICAgICAgfSkgIA0KICAgICAgICB9ICAgICANCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLnJlZnJlc2hfY2FwdGNoYSgpDQogIH0sDQoNCiAgDQogDQp9DQo="},{"version":3,"sources":["LoginComponent.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA","file":"LoginComponent.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <el-form\r\n    :model=\"ruleForm\"\r\n    :rules=\"rules\"\r\n    ref=\"ruleForm\"\r\n    label-width=\"80px\"\r\n    class=\"demo-ruleForm\"\r\n  >\r\n    <el-form-item label=\"用户名\" prop=\"username\">\r\n      <el-input\r\n        prefix-icon=\"el-icon-user-solid\"\r\n        v-model=\"ruleForm.username\"\r\n      ></el-input>\r\n    </el-form-item>\r\n\r\n    <el-form-item label=\"密码\" prop=\"password\">\r\n      <el-input\r\n        prefix-icon=\"el-icon-lock\" type=\"password\"\r\n        v-model=\"ruleForm.password\"\r\n      ></el-input>\r\n    </el-form-item>\r\n\r\n    <!-- <el-form-item label=\"验证码\" prop=\"captcha\">\r\n        <el-row type=\"flex\" class=\"row-bg\" justify=\"space-between\">\r\n            <el-col :span=\"11\">\r\n                <el-input\r\n                prefix-icon=\"el-icon-view\"\r\n                v-model=\"ruleForm.captcha\"\r\n                ></el-input>\r\n            </el-col>\r\n            <el-col :span=\"11\" style=\"line-height: 100%\">\r\n                <img :src=\"captcha_url\" alt=\"\" @click=\"refresh_captcha()\" style=\" cursor:pointer;\" />\r\n                <el-input type=\"hidden\" name=\"captcha_key\" v-model=\"ruleForm.captcha_key\" style=\"display: none;\" ></el-input>\r\n            </el-col>\r\n      </el-row>\r\n    </el-form-item> -->\r\n\r\n    <el-form-item>\r\n      <el-row type=\"flex\" class=\"row-bg\" justify=\"space-between\">\r\n        <el-col :span=\"11\">\r\n          <el-button\r\n            type=\"primary\"\r\n            @click=\"submitForm('ruleForm')\"\r\n            style=\"width: 100%\"\r\n            >登&nbsp;&nbsp;录</el-button\r\n          >\r\n        </el-col>\r\n        <el-col :span=\"11\">\r\n          <el-button @click=\"resetForm('ruleForm')\" style=\"width: 100%\"\r\n            >重&nbsp;&nbsp;置</el-button\r\n          >\r\n        </el-col>\r\n      </el-row>\r\n    </el-form-item>\r\n  </el-form>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: \"LoginComponent\",\r\n    data() {\r\n        return {\r\n            captcha_url: \"\",\r\n            ruleForm: {\r\n                //captcha_key: \"\",\r\n                //captcha: \"\",\r\n                username: \"\",\r\n                password: \"\",\r\n            },\r\n            rules: {\r\n                username: [\r\n                { required: true, message: \"请输入用户名\", trigger: \"blur\" },\r\n                ],\r\n                password: [{ required: true, message: \"请输入密码\", trigger: \"blur\" }],\r\n                captcha: [{ required: false, message: \"请输入验证码\", trigger: \"blur\" }],\r\n            },\r\n        };\r\n    },\r\n    methods: {\r\n        submitForm(formName) {\r\n            this.$refs[formName].validate((valid) => {\r\n                if (valid) {\r\n                    this.axios.post('user/login', this.ruleForm).then((response) => {\r\n                        let token = response.data.token\r\n                        let id = response.data.id\r\n                        this.$store.commit('saveUserInfo', {'username': this.ruleForm.username, 'token': token, 'id': id})\r\n                        this.$router.push({name: 'Home'})\r\n                    }).catch((error) => {\r\n                        this.refresh_captcha()\r\n                        this.$message.error(error.response.data.detail);                        \r\n                    })\r\n                } else {\r\n                    console.log('error submit!!');\r\n                    return false;\r\n                }\r\n            });\r\n        },\r\n        resetForm(formName) {\r\n            this.$refs[formName].resetFields();\r\n        },\r\n        refresh_captcha() {\r\n            this.axios.get('captcha/refresh/', { headers : {'X-Requested-With': 'XMLHttpRequest'} }).then((response) => {\r\n                this.captcha_url = response.data.image_url;\r\n                this.ruleForm.captcha_key = response.data.key;\r\n            })  \r\n        }     \r\n  },\r\n  mounted() {\r\n    this.refresh_captcha()\r\n  },\r\n\r\n  \r\n \r\n}\r\n</script>"]}]}